

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting VEnCodes &mdash; VEnCode  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Preparing the data" href="data_prep.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> VEnCode
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="main_tools.html">Main Tools</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data_prep.html">Preparing the data</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Getting VEnCodes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-VEnCode.internals">Objects</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VEnCode</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="main_tools.html">Main Tools</a> &raquo;</li>
        
      <li>Getting VEnCodes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/get_vencodes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="getting-vencodes">
<h1>Getting VEnCodes<a class="headerlink" href="#getting-vencodes" title="Permalink to this headline">¶</a></h1>
<p>Here listed is the documentation to the “Vencode” object, the main object in this module.</p>
<p>Pay special attention to the type of data needed to feed this object, its arguments and main methods.</p>
<div class="section" id="module-VEnCode.internals">
<span id="objects"></span><h2>Objects<a class="headerlink" href="#module-VEnCode.internals" title="Permalink to this headline">¶</a></h2>
<p>internals.py: Classes module for the VEnCode project</p>
<dl class="py class">
<dt id="VEnCode.internals.Vencodes">
<em class="property">class </em><code class="sig-prename descclassname">VEnCode.internals.</code><code class="sig-name descname">Vencodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_object</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'heuristic'</span></em>, <em class="sig-param"><span class="n">number_of_re</span><span class="o">=</span><span class="default_value">4</span></em>, <em class="sig-param"><span class="n">n_samples</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">stop</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">second_data_object</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">using</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes" title="Permalink to this definition">¶</a></dt>
<dd><p>An Object representing the VEnCodes found for a specific celltype. VEnCodes are combinations of regulatory elements
that are active specifically in one celltype and inactive in all others.
This class contains methods to search, retrieve, classify and visualize VEnCodes from a matrix of regulatory
element (rows) expression levels per celltype (columns).</p>
<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.vencodes">
<code class="sig-name descname">vencodes</code><a class="headerlink" href="#VEnCode.internals.Vencodes.vencodes" title="Permalink to this definition">¶</a></dt>
<dd><p>List of coordinates for the regulatory elements that constitute the VEnCodes found. There are other ways of
retrieving VEnCode information, see Methods. To generate a list of VEnCodes, use the <cite>next()</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.e_values">
<code class="sig-name descname">e_values</code><a class="headerlink" href="#VEnCode.internals.Vencodes.e_values" title="Permalink to this definition">¶</a></dt>
<dd><p><cite>E</cite> value score for the VEnCodes found. Must be first determined using the <cite>determine_e_values()</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.data">
<code class="sig-name descname">data</code><a class="headerlink" href="#VEnCode.internals.Vencodes.data" title="Permalink to this definition">¶</a></dt>
<dd><p>The original data set used to find VEnCodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference internal" href="data_prep.html#VEnCode.internals.DataTpm" title="VEnCode.internals.DataTpm">DataTpm</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.algorithm">
<code class="sig-name descname">algorithm</code><a class="headerlink" href="#VEnCode.internals.Vencodes.algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Algorithm used to find VEnCodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.k">
<code class="sig-name descname">k</code><a class="headerlink" href="#VEnCode.internals.Vencodes.k" title="Permalink to this definition">¶</a></dt>
<dd><p>The VEnCode size. In other words, the number of regulatory elements that form each VEnCode.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.target_replicates">
<code class="sig-name descname">target_replicates</code><a class="headerlink" href="#VEnCode.internals.Vencodes.target_replicates" title="Permalink to this definition">¶</a></dt>
<dd><p>The target samples names to retrieve VEnCodes from.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of str, str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="VEnCode.internals.Vencodes.target_replicates_data">
<code class="sig-name descname">target_replicates_data</code><a class="headerlink" href="#VEnCode.internals.Vencodes.target_replicates_data" title="Permalink to this definition">¶</a></dt>
<dd><p>A shortcut to the subset of the data corresponding to the target samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_object</strong> (<a class="reference internal" href="data_prep.html#VEnCode.internals.DataTpm" title="VEnCode.internals.DataTpm"><em>DataTpm</em></a><em>, </em><em>pd.DataFrame</em>) – Data to use in finding VEnCodes. This should be a matrix of regulatory elements (rows) expression levels per
celltype (columns). The matrix can be supplied as a DataTpm object, which has methods to quickly prepare the
data, or as a pandas DataFrame object.</p></li>
<li><p><strong>algorithm</strong> (<em>{'heuristic'</em><em>, </em><em>'sampling'}</em><em>, </em><em>optional</em>) – Algorithm to find VEnCodes.</p></li>
<li><p><strong>number_of_re</strong> (<em>int</em>) – VEnCode size. In other words, the number of regulatory elements that should form each VEnCode.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – Number of random samples to take to try to find a VEnCode. Used only if <code class="docutils literal notranslate"><span class="pre">algorithm=&quot;sampling&quot;</span></code></p></li>
<li><p><strong>stop</strong> (<em>int</em>) – Number of promoters to test per node level. Used only if <code class="docutils literal notranslate"><span class="pre">algorithm=&quot;heuristic&quot;</span></code></p></li>
<li><p><strong>second_data_object</strong> (<a class="reference internal" href="data_prep.html#VEnCode.internals.DataTpm" title="VEnCode.internals.DataTpm"><em>DataTpm</em></a><em>, </em><em>None</em>) – If the current VEnCode object contains as source a set of promoter expression, supplying an enhancer DataTpm
object here will allow retrieval of hybrid enhancer-promoter VEnCodes.</p></li>
<li><p><strong>using</strong> (<em>str</em><em>, </em><em>list</em><em>, </em><em>None</em>) – Allows the user to force some REs to be in the VEnCode, if possible.</p></li>
<li><p><strong>target</strong> (<em>str</em><em>, </em><em>None</em>) – When supplying the VEnCode object with a DataFrame, the target celltype must be specified here.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="VEnCode.internals.Vencodes.next">
<code class="sig-name descname">next</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">amount</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.next" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to generate the next VEnCode. The VEnCode is appended to the variable <cite>vencodes</cite> and
can also be returned as a variable.</p>
</dd></dl>

<dl class="py method">
<dt id="VEnCode.internals.Vencodes.determine_e_values">
<code class="sig-name descname">determine_e_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">repetitions</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.determine_e_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to generate e-values for the current VEnCodes. E-values will be stored in the variable
called e_values. Method applied to calculate e-values is a Monte-Carlo simulation.</p>
</dd></dl>

<dl class="py method">
<dt>
<code class="sig-name descname">export(*args, path=None, verbose=True):</code></dt>
<dd><p>Call this method to export vencode related values to CSV files.
Put “vencodes” in the arguments to export each VEnCode to a CSV file, “e-values” to export the e-values,
and “TPP” to export the tags per million expression of the REs that comprise the VEnCodes for the target
celltype.
You can put any amount of these arguments in the same function as long as they are supported.
Use <cite>path</cite> to define a specific directory to store the file. (must be a complete path)</p>
</dd></dl>

<dl class="py method">
<dt id="id0">
<code class="sig-name descname">determine_e_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">repetitions</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to generate <cite>e</cite> values for the current VEnCodes. <cite>E</cite> values will be stored in the variable
called <cite>e_values</cite>. The method applied to calculate <cite>e</cite> values is a Monte-Carlo simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>repetitions</strong> (<em>int</em>) – Number of times each vencode is evaluated to get the average value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="VEnCode.internals.Vencodes.export">
<code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this method to export vencode related values to CSV files.
Put “vencodes” in the arguments to export each VEnCode to a CSV file, “e-values” to export the e-values,
and “TPP” to export the tags per million expression of the REs that comprise the VEnCodes for the target
celltype.
You can put any amount of these arguments in the same function as long as they are supported.
Use <cite>path</cite> to define a specific directory to store the file. (must be a complete path)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – “e-values”, “vencodes”, “TPP” or even all at once.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>None</em>) – Path to write a file to store the VEnCode data.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Either to allow the function to print messages to console (<cite>True</cite>), or not (<cite>False</cite>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="VEnCode.internals.Vencodes.get_vencode_data">
<code class="sig-name descname">get_vencode_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'return'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.get_vencode_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to get the VEnCode data as a variable (<code class="docutils literal notranslate"><span class="pre">method=&quot;return&quot;</span></code>),
or printed in terminal (<code class="docutils literal notranslate"><span class="pre">method=&quot;print&quot;</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>method</strong> (<em>str</em>) – How to retrieve the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="id1">
<code class="sig-name descname">next</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">amount</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to generate the next VEnCode. The VEnCode is appended to the variable <cite>vencodes</cite> and
can also be returned as a variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>amount</strong> (<em>int</em>) – Number of vencodes to retrieve.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list containing the desired amount of vencodes.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="VEnCode.internals.Vencodes.next_heuristic2_vencode">
<code class="sig-name descname">next_heuristic2_vencode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">second_data_object</span></em>, <em class="sig-param"><span class="n">amount</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.next_heuristic2_vencode" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to generate the next VEnCode, possibly hybrid enhancer-promoter VEnCode.
The VEnCode is appended to the variable self.vencodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>second_data_object</strong> (<a class="reference internal" href="data_prep.html#VEnCode.internals.DataTpm" title="VEnCode.internals.DataTpm"><em>DataTpm</em></a>) – If the current VEnCode object contains as source a set of promoter expression, supplying an enhancer DataTpm
object here will allow retrieval of hybrid enhancer-promoter VEnCodes.</p></li>
<li><p><strong>amount</strong> (<em>int</em>) – Number of vencodes to retrieve.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="VEnCode.internals.Vencodes.vencode_mc_simulation">
<em class="property">static </em><code class="sig-name descname">vencode_mc_simulation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">reps</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.vencode_mc_simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates turning 0s to 1s over a data set, asking each turn if the data still represents a VEnCode.
Tests the VEnCode robustness to false negatives in the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – Data frame of promoter expression per celltype without the celltype of interest.</p></li>
<li><p><strong>reps</strong> (<em>int</em>) – Number of simulations to run.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The <cite>e</cite> value, that is, the average number of random changes done to the data until it breaks the VEnCode.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="VEnCode.internals.Vencodes.view_vencodes">
<code class="sig-name descname">view_vencodes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'print'</span></em>, <em class="sig-param"><span class="n">interpolation</span><span class="o">=</span><span class="default_value">'nearest'</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">snapshot</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#VEnCode.internals.Vencodes.view_vencodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Call this function to get an heat map visualization of the vencodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Method to view VEnCodes. “print” to get visualization on terminal. “write” to write to a file. “both” for
both.</p></li>
<li><p><strong>interpolation</strong> (<em>str</em>) – Method for heat map interpolation.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>None</em>) – Optional path for the file.</p></li>
<li><p><strong>snapshot</strong> (<em>int</em><em>, </em><em>None</em>) – Number of celltypes to show in heat map. <cite>False</cite> gets all but may hinder visualization.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Either to allow the function to print messages to console (<cite>True</cite>), or not (<cite>False</cite>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="data_prep.html" class="btn btn-neutral float-left" title="Preparing the data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, André Macedo, Alisson M. Gontijo

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>